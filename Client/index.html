<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Вход</title>
<style>
  body { font-family: sans-serif; max-width: 400px; margin: 40px auto; }
  input { width: 100%; padding: 6px; margin-bottom: 10px; }
  button { padding: 8px 14px; }
</style>
</head>
<body>

<h2>Авторизация</h2>

<input id="username" placeholder="Логин">
<input id="password" type="password" placeholder="Пароль">

<button id="loginBtn">Войти</button>
<button id="regBtn">Регистрация</button>

<p id="msg"></p>

<script src="api.js"></script>

<script>
// Выводит текст под кнопками
function showMessage(text) {
    document.getElementById("msg").textContent = text;
}

// Нажатие кнопки "Войти"
document.getElementById("loginBtn").onclick = async () => {
    const u = username.value;
    const p = password.value;

    const res = await login(u, p);

    if (res.token) {
        localStorage.setItem("token", res.token);
        window.location = "main.html";
    } else {
        showMessage(res.error || "Ошибка");
    }
};

// Нажатие кнопки "Регистрация"
document.getElementById("regBtn").onclick = async () => {
    const u = username.value;
    const p = password.value;

    const res = await register(u, p);

    showMessage(res.message || res.error);
};
</script>

</body>
</html>
